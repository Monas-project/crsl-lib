# 実装計画

- [ ] 1. DagGraphに最新バージョン計算機能を実装
  - `calculate_latest()`メソッドを追加してgenesis IDから最新バージョンを計算する
  - `get_all_versions_for_genesis()`ヘルパーメソッドを実装してgenesis関連ノードを取得する
  - リーフノード特定アルゴリズムを実装して子を持たないノードを見つける
  - _要件: 1.1, 1.4, 3.1, 4.1, 4.3_

- [ ] 2. DagGraphの単体テストを作成
  - 単一バージョン（genesisのみ）のテストケースを作成する
  - 線形履歴（複数バージョン）のテストケースを作成する
  - 分岐履歴（複数リーフ）のテストケースを作成する
  - 存在しないgenesis IDのテストケースを作成する
  - _要件: 1.2, 4.1, 4.2_

- [ ] 3. Repoレイヤーのlatest()メソッドを更新
  - `latest()`メソッドを計算ベースに変更してDAGから最新バージョンを取得する
  - 既存のインターフェースを維持して後方互換性を保つ
  - エラーハンドリングを実装してNoneとエラーを適切に処理する
  - _要件: 1.1, 2.1, 6.1_

- [ ] 4. commit_operationメソッドを更新
  - headsフィールドへの保存を削除して計算ベースに移行する
  - 親ノード取得を`latest()`メソッド経由に変更する
  - 既存の動作を維持してCreate/Update/Delete操作が正常に動作することを確認する
  - _要件: 2.2, 6.3_

- [ ] 5. Repoレイヤーの単体テストを作成
  - `latest()`メソッドの正常ケースをテストする
  - 存在しないgenesis IDでのNone返却をテストする
  - `commit_operation()`の動作確認テストを作成する
  - _要件: 1.1, 1.2, 2.3_

- [ ] 6. CLIのshowコマンドを拡張
  - 最新バージョンCIDの表示機能を追加する
  - Genesis情報の表示機能を追加する
  - 要求されたバージョンと最新バージョンの関係を明確に表示する
  - _要件: 5.1, 5.2, 5.3_

- [ ] 7. CLI統合テストを作成
  - `show`コマンドでの最新バージョン表示をテストする
  - 複数バージョンがある場合の表示をテストする
  - エラーケースでの適切な表示をテストする
  - _要件: 5.1, 5.2, 5.3_

- [ ] 8. パフォーマンステストを実装
  - 大量ノード（1000+）での計算時間を測定するテストを作成する
  - メモリ使用量を監視するテストを作成する
  - 複数コンテンツでの独立性を確認するテストを作成する
  - _要件: 3.1, 3.2, 3.3_

- [ ] 9. エラーハンドリングの統合テスト
  - ノード取得エラー時の適切な伝播をテストする
  - Genesis ID不存在時のNone返却をテストする
  - 各レイヤーでのエラー処理の一貫性をテストする
  - _要件: 1.2, 2.1_

- [ ] 10. 全体統合テストとドキュメント更新
  - 全機能の統合動作テストを実行する
  - READMEに新機能の使用例を追加する
  - APIドキュメントを更新して新しいメソッドを説明する
  - パフォーマンス特性をドキュメント化する
  - _要件: 6.1, 6.3_